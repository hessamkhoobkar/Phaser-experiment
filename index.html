<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Phaser experiment</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>

    <style>
      body {
        padding: 0;
        margin: 0;
        background-color: black;
      }
    </style>
  </head>
  <body>
    <script>
      var config = {
        type: Phaser.AUTO,
        scale: {
          mode: Phaser.Scale.FIT,
          autoCenter: Phaser.Scale.CENTER_BOTH,
          width: 1920,
          height: 1080,
        },
        scene: {
          preload: preload,
          create: create,
        },
      };

      var game = new Phaser.Game(config);

      function preload() {
        this.load.image("gameStage", "assets/gameStage.png");
        this.load.atlas("cards", "assets/cards.png", "assets/cards.json");
        this.load.atlas("chips", "assets/chips.png", "assets/chips.json");
        this.load.image("chipShadow", "assets/chipShadow.png");
      }

      function create() {
        // Game Table
        let gameStage = this.add.image(960, 540, "gameStage");

        //  Stack of cards
        let cards = this.textures.get("cards").getFrameNames();

        let x = 330;
        let y = 200;

        cards.forEach((card) => {
          let currentCard = this.add
            .image(x, y, "cards", card)
            .setInteractive({ cursor: "pointer" });

          this.input.setDraggable(currentCard);

          x += 24;
        });

        // On Drag start bring it up & move it to pointer
        this.input.on(
          "dragstart",
          function (pointer, gameObject) {
            this.children.bringToTop(gameObject);
          },
          this
        );

        this.input.on("drag", function (pointer, gameObject, dragX, dragY) {
          gameObject.x = dragX;
          gameObject.y = dragY;
        });

        //  Stack of chips
        let chips = this.textures.get("chips").getFrameNames();

        let chipsX = 420;
        let chipsY = 400;

        chips.forEach((chip) => {
          let currentchip = this.add
            .image(chipsX, chipsY, "chips", chip)
            .setInteractive({ cursor: "pointer" });

          this.input.setDraggable(currentchip);

          chipsX += 108;
        });

        // Chips for bottom page from a uniqe array with diffrent setInteractive
        let bottomChips = this.textures.get("chips").getFrameNames();

        let bottomChipsX = 1400;
        let bottomChipsY = 1000;

        let betableAmounts = ["chip1", "chip5", "chip10", "chip25", "chip50"];

        bottomChips.forEach((bottomChip) => {
          if (betableAmounts.includes(bottomChip)) {
            let currentShadow = this.add.image(
              bottomChipsX,
              bottomChipsY + 32,
              "chipShadow"
            );

            let currentchip = this.add
              .image(bottomChipsX, bottomChipsY, "chips", bottomChip)
              .setInteractive({ cursor: "pointer" });

            currentchip.on("pointerover", function (event) {
              this.setScale(1.25);
              currentShadow.setScale(1.25);
            });

            currentchip.on("pointerout", function (event) {
              this.setScale(1);
              currentShadow.setScale(1);
            });

            bottomChipsX += 112;
          }
        });
      }
    </script>
  </body>
</html>
